if(WIN32)
  add_definitions(-D_SCL_SECURE_NO_WARNINGS -DTETERRALIBUTILSDLL -D_CRT_SECURE_NO_WARNINGS -DBOOST_LOG_DYN_LINK)
endif()

include_directories(
  ${TERRALIB_UTILS_ABSOLUTE_ROOT_DIR}/src
  ${terralib_INCLUDE_DIRS}
  ${terralib_DIR}
  ${Boost_INCLUDE_DIR}
  ${Boost_INCLUDE_DIR}/qwt
)

file(GLOB TERRALIBUTILS_SRC_FILES ${TERRALIB_UTILS_ABSOLUTE_ROOT_DIR}/src/terralib_utils/*.cpp)
file(GLOB TERRALIBUTILS_HDR_FILES ${TERRALIB_UTILS_ABSOLUTE_ROOT_DIR}/src/terralib_utils/*.h)

source_group("Source Files"  FILES ${TERRALIBUTILS_SRC_FILES})
source_group("Header Files"  FILES ${TERRALIBUTILS_HDR_FILES})

add_library(terralib_utils SHARED ${TERRALIBUTILS_SRC_FILES} ${TERRALIBUTILS_HDR_FILES})

set(TERRALIBUTILS_LIBRARIES_DEPENDENCIES "terralib_mod_common")
list(APPEND TERRALIBUTILS_LIBRARIES_DEPENDENCIES "terralib_mod_core")
list(APPEND TERRALIBUTILS_LIBRARIES_DEPENDENCIES "terralib_mod_dataaccess")
list(APPEND TERRALIBUTILS_LIBRARIES_DEPENDENCIES "terralib_mod_geometry")
list(APPEND TERRALIBUTILS_LIBRARIES_DEPENDENCIES "terralib_mod_memory")
list(APPEND TERRALIBUTILS_LIBRARIES_DEPENDENCIES "terralib_mod_raster")
list(APPEND TERRALIBUTILS_LIBRARIES_DEPENDENCIES ${Boost_THREAD_LIBRARY})

target_link_libraries(terralib_utils ${TERRALIBUTILS_LIBRARIES_DEPENDENCIES})

set_target_properties(terralib_utils
                      PROPERTIES VERSION ${TERRALIB_UTILS_VERSION_MAJOR}.${TERRALIB_UTILS_VERSION_MINOR}
                                 SOVERSION ${TERRALIB_UTILS_VERSION_MAJOR}.${TERRALIB_UTILS_VERSION_MINOR})

install(TARGETS terralib_utils
        EXPORT terralibUtils-targets
        RUNTIME DESTINATION ${TERRALIB_UTILS_DESTINATION_RUNTIME} COMPONENT runtime
        LIBRARY DESTINATION ${TERRALIB_UTILS_DESTINATION_LIBRARY} COMPONENT runtime
        ARCHIVE DESTINATION ${TERRALIB_UTILS_DESTINATION_ARCHIVE} COMPONENT runtime)

install(FILES ${TERRALIBUTILS_HDR_FILES}
        DESTINATION ${TERRALIB_UTILS_DESTINATION_HEADERS}/terralib_utils COMPONENT devel)

export(TARGETS terralib_utils APPEND FILE ${CMAKE_BINARY_DIR}/terralibUtils-exports.cmake)
